---
title: DataFrames - Part 1
sidebar_label: DataFrames - Part 1
sidebar_position: 3
---

## Introduction to DataFrames

A **DataFrame** is the most important data structure in **Pandas**. It is a **two-dimensional labeled data structure**, similar to a table in a database or an Excel spreadsheet.

Key points:

* A DataFrame is a **collection of Series objects** that share a common index.
* Each **column** in a DataFrame is a Pandas Series.
* DataFrames allow us to store, manipulate, and analyze tabular data with ease.

---

## Creating a DataFrame

We usually start by importing libraries:

```python
import numpy as np
import pandas as pd
from numpy.random import randn
```

Setting a **seed** ensures reproducible random numbers:

```python
np.random.seed(101)
```

Now, let’s create a DataFrame:

```python
df = pd.DataFrame(randn(5,4), index=['A','B','C','D','E'], columns=['W','X','Y','Z'])
print(df)
```

* The DataFrame has 5 rows (`A`–`E`) and 4 columns (`W,X,Y,Z`).
* Each column (`W`, `X`, `Y`, `Z`) is actually a **Series**.

---

## Selecting Columns

### Single Column

```python
df['W']
```

* Returns a **Series**.
* Type: `<class 'pandas.core.series.Series'>`.

```python
type(df)   # <class 'pandas.core.frame.DataFrame'>
```

### Dot Notation (Not Recommended)

```python
df.W
```

* Works, but can conflict with method names (e.g., `df.count` could mean a column or a method).
* Best practice: **always use brackets**.

---

## Selecting Multiple Columns

```python
df[['W','Z']]
```

* Returns a **DataFrame** with selected columns.
* Asking for **one column → Series**; **multiple columns → DataFrame**.

---

## Creating New Columns

You can create a new column using operations on existing ones:

```python
df['new'] = df['W'] + df['Y']
print(df)
```

* A new column `new` is added.

---

## Dropping Columns and Rows

### Drop a Column

```python
df.drop('new', axis=1)
```

* Axis `1` = column.
* By default, drop is **not permanent**.

```python
df.drop('new', axis=1, inplace=True)
```

* Permanently removes the column.

### Drop a Row

```python
df.drop('E', axis=0)
```

* Axis `0` = row.

### Shape

```python
df.shape
```

* Returns `(rows, columns)`.
* Index `0` → rows; Index `1` → columns.

---

## Selecting Rows

Two main methods:

* `.loc` → **label-based selection**
* `.iloc` → **integer-based selection**

### By Label

```python
df.loc['C']
```

* Returns the row labeled `'C'`.

### By Position

```python
df.iloc[2]
```

* Returns the row at position `2` (which is `'C'`).

---

## Selecting Subsets of Rows and Columns

You can combine row and column selection with `.loc`:

```python
df.loc[['A','B'], ['W','Y']]
```

* Returns rows `A` and `B` with columns `W` and `Y`.

---

## Review

* **Creating**: use `pd.DataFrame(data, index, columns)`.
* **Columns**: select with brackets `df['col']` or list `df[['col1','col2']]`.
* **New column**: define it with operations on existing ones.
* **Drop**: use `.drop()`, with `axis` (0=row, 1=column) and `inplace=True` if permanent.
* **Rows**: select with `.loc` (labels) or `.iloc` (positions).
* **Subsets**: pass lists of row and column labels to `.loc`.

---

## Advanced Examples

### 1. Adding a Derived Column

```python
df['ratio'] = df['W'] / df['Z']
```

* Creates a new column based on column arithmetic.

### 2. Conditional Row Selection

```python
df[df['W'] > 0]
```

* Selects rows where column `W` has positive values.

### 3. Combining Row and Column Filters

```python
df.loc[df['Y'] > 1, ['W','Y']]
```

* Selects only rows where `Y > 1`, returning only columns `W` and `Y`.

### 4. Reset and Set Index

```python
df.reset_index(inplace=True)
df.set_index('new_index_col', inplace=True)
```

* Control how rows are labeled.

---

## Practice Questions

1. What is the difference between a Pandas Series and a DataFrame?
2. Write code to select only the columns `X` and `Z` from `df`.
3. How do you permanently remove a column from a DataFrame?
4. What is the difference between `.loc` and `.iloc`?
5. Write code to create a new column that is the product of columns `W` and `Y`.
6. How do you drop row `'B'` from `df`?

---

## Answers

1. **Series** = one-dimensional labeled array; **DataFrame** = two-dimensional structure (collection of Series sharing the same index).
2. `df[['X','Z']]`
3. `df.drop('col_name', axis=1, inplace=True)`
4. `.loc` selects rows/columns by **labels**, `.iloc` selects by **integer positions**.
5. `df['new'] = df['W'] * df['Y']`
6. `df.drop('B', axis=0, inplace=True)`
