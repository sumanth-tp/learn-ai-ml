---
title: Handling Missing Data in Pandas
sidebar_label: Handling Missing Data in Pandas
sidebar_position: 6
---

## Introduction

In real-world datasets, **missing values** are common. They can appear due to incomplete surveys, corrupted files, failed sensors, or mismatched joins.

When Pandas encounters missing data, it represents it as:

* `NaN` (**Not a Number**) for numerical data
* `None` or `NaT` (for datetime) in some cases

Handling missing data properly is critical:

* **Dropping** missing values avoids contamination of analyses but may reduce dataset size.
* **Filling** missing values (imputation) preserves dataset size and can improve model stability if done carefully.

Pandas provides convenient methods such as **`dropna`** and **`fillna`** for cleaning and imputing missing data.

---

## Creating a DataFrame with Missing Values

```python
import numpy as np
import pandas as pd

d = {
    'A': [1, 2, np.nan],
    'B': [5, np.nan, np.nan],
    'C': [1, 2, 3]
}
df = pd.DataFrame(d)
print(df)
```

**Output:**

```
     A    B  C
0  1.0  5.0  1
1  2.0  NaN  2
2  NaN  NaN  3
```

Observations:

- Column **A** has one missing value (`NaN`).
- Column **B** has two missing values.
- Column **C** is complete (no missing values).

---

## Dropping Missing Values with `dropna`

### 1. Drop rows with any missing values

```python
df.dropna()
```

Keeps only complete rows. **Result:** Only row 0 remains because rows 1 and 2
have missing values.

---

### 2. Drop columns with any missing values

```python
df.dropna(axis=1)
```

Drops entire columns if they contain at least one missing value. **Result:**
Only column `C` remains because `A` and `B` have `NaN`.

---

### 3. Drop rows with a threshold of non-missing values

```python
df.dropna(thresh=2)
```

- `thresh=2` → Keep rows with at least 2 non-null values.
- Row 0 (`A=1, B=5, C=1`) has 3 non-null values → kept.
- Row 1 (`A=2, B=NaN, C=2`) has 2 non-null values → kept.
- Row 2 (`A=NaN, B=NaN, C=3`) has only 1 non-null value → dropped.

---

## Filling Missing Values with `fillna`

Instead of dropping data, you can replace missing values.

### 1. Fill with a constant

```python
df.fillna('FILL VALUE')
```

Replaces all missing values with the string `"FILL VALUE"`.

---

### 2. Fill with column mean

```python
df['A'].fillna(df['A'].mean())
```

- Column `A`: mean = `(1 + 2) / 2 = 1.5`
- Missing values in `A` replaced with `1.5`.

---

### 3. Fill with different values per column

```python
df.fillna({'A': df['A'].mean(), 'B': 0})
```

- Fill missing values in `A` with its mean.
- Fill missing values in `B` with `0`.

---

### 4. Forward Fill (propagate last valid value)

```python
df.fillna(method='ffill')
```

Copies the last known value downwards into missing entries.

---

### 5. Backward Fill (propagate next valid value)

```python
df.fillna(method='bfill')
```

Copies the next known value upwards into missing entries.

---

## Advanced Examples

### 1. Interpolation for Numeric Data

```python
df['A'].interpolate()
```

Fills missing values in column `A` using **linear interpolation** between
surrounding values.

---

### 2. Limit Forward Fill

```python
df.fillna(method='ffill', limit=1)
```

Forward fill only **one step**, preventing long chains of fills.

---

### 3. Conditional Fill with `apply`

```python
df['B'] = df['B'].apply(lambda x: 0 if pd.isna(x) else x)
```

Replaces missing values in column `B` with `0` using a custom function.

---

### 4. Detect Missing Data

```python
df.isnull()   # Boolean DataFrame
df.notnull()  # Opposite
df.isnull().sum()  # Count missing values per column
```

---

## Key Takeaways

1. **`dropna()`** removes rows/columns with missing values; customize with
   `axis` and `thresh`.
2. **`fillna()`** replaces missing values with constants, statistics, or
   propagation (`ffill`, `bfill`).
3. **Interpolation** fills numeric gaps smoothly.
4. **Always analyze the pattern of missingness** before deciding on a strategy.
5. Handling missing data is essential for **data cleaning, modeling, and
   analysis**.

---

## Practice Questions

1. What does Pandas use to represent missing values in numerical columns?
2. Write code to drop all columns with missing values from a DataFrame.
3. How would you drop rows that have fewer than 2 non-null values?
4. Fill all missing values in column `B` with `0`.
5. Replace missing values in column `A` with the mean of that column.
6. Demonstrate forward fill and backward fill on a DataFrame with missing
   values.
7. How do you count the number of missing values in each column?
8. Give one real-world example where you should **not drop** missing values but
   rather **fill** them.

---

## Answers

1. **NaN** (`numpy.nan`).
2. ```python
   df.dropna(axis=1)
   ```
3. ```python
   df.dropna(thresh=2)
   ```
4. ```python
   df['B'].fillna(0, inplace=True)
   ```
5. ```python
   df['A'].fillna(df['A'].mean(), inplace=True)
   ```
6. ```python
   df.fillna(method='ffill')   # Forward fill
   df.fillna(method='bfill')   # Backward fill
   ```
7. ```python
   df.isnull().sum()
   ```
8. **Example**: In time-series data (e.g., stock prices or sensor readings),
   dropping missing values may break continuity. It’s better to **forward fill**
   or **interpolate**.
