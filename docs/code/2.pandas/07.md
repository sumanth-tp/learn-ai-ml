---
title: GroupBy in Pandas - Grouping Data and Aggregation
sidebar_label: GroupBy
sidebar_position: 7
---

## Introduction

In data analysis, it’s common to summarize or categorize data — for example,
finding the total sales per company or the average score per student. Pandas
provides a powerful and intuitive way to do this through the **`groupby()`**
method.

The **GroupBy** operation in Pandas involves three key steps:

1. **Splitting** data into groups based on some criteria (e.g., column values).
2. **Applying** an aggregate function (like sum, mean, or count) to each group.
3. **Combining** the results into a new DataFrame.

This is conceptually similar to SQL’s `GROUP BY` clause and is one of the most
used operations in data manipulation and summarization.

---

## Example Dataset

Let’s start by creating a simple dataset.

```python
import pandas as pd

data = {
    'Company': ['Google', 'Google', 'Microsoft', 'Microsoft', 'Facebook', 'Facebook'],
    'Person': ['Sam', 'Charlie', 'Amy', 'Vanessa', 'Carl', 'Sarah'],
    'Sales': [200, 120, 340, 124, 243, 350]
}

df = pd.DataFrame(data)
print(df)
```

**Output:**

```
    Company   Person  Sales
0    Google      Sam    200
1    Google  Charlie    120
2  Microsoft      Amy    340
3  Microsoft  Vanessa    124
4   Facebook     Carl    243
5   Facebook    Sarah    350
```

---

## Understanding `groupby()`

The **`groupby()`** method allows you to group rows that share a common value in
one or more columns.

```python
by_company = df.groupby('Company')
```

This creates a **GroupBy object**, which is not yet a DataFrame but can be
aggregated with various methods.

### Example — Mean Sales by Company

```python
by_company.mean()
```

**Output:**

```
             Sales
Company
Facebook     296.5
Google       160.0
Microsoft    232.0
```

> Non-numeric columns (like `Person`) are automatically excluded from numerical
> aggregation.

---

## Common Aggregate Functions

Pandas provides several built-in aggregation methods:

| Function   | Description                     |
| ---------- | ------------------------------- |
| `.sum()`   | Adds up all values per group    |
| `.mean()`  | Calculates the mean per group   |
| `.std()`   | Returns standard deviation      |
| `.count()` | Counts non-null values          |
| `.max()`   | Returns maximum value per group |
| `.min()`   | Returns minimum value per group |

### Example

```python
by_company.sum()
by_company.std()
by_company.count()
```

**To get total sales for one company:**

```python
by_company.sum().loc['Facebook']
```

or directly:

```python
df.groupby('Company').sum().loc['Facebook']
```

**Output:**

```
Sales    593
Name: Facebook, dtype: int64
```

---

## Using `describe()` with GroupBy

To get multiple summary statistics at once:

```python
df.groupby('Company').describe()
```

**Output:**

```
              Sales
Company
Facebook  count    2.000000
          mean   296.500000
          std     75.660426
          min    243.000000
          25%    269.750000
          50%    296.500000
          75%    323.250000
          max    350.000000
Google    count    2.000000
          mean   160.000000
          ...
```

If you prefer the companies as columns:

```python
df.groupby('Company').describe().transpose()
```

---

## Accessing Grouped Data

You can select groups and apply transformations or aggregations manually.

### Access a Single Group

```python
by_company.get_group('Google')
```

Returns all rows belonging to Google.

### Aggregate Multiple Columns

```python
df.groupby('Company').agg({'Sales': ['mean', 'sum', 'max']})
```

**Output:**

```
              Sales
              mean  sum  max
Company
Facebook      296.5  593  350
Google        160.0  320  200
Microsoft     232.0  464  340
```

---

## Advanced Examples

### 1. Multiple Column Grouping

```python
data = {
    'Company': ['Google', 'Google', 'Microsoft', 'Microsoft', 'Facebook', 'Facebook'],
    'Department': ['IT', 'HR', 'IT', 'HR', 'IT', 'HR'],
    'Sales': [200, 120, 340, 124, 243, 350]
}

df = pd.DataFrame(data)
df.groupby(['Company', 'Department']).mean()
```

This groups by both `Company` and `Department`.

---

### 2. Using Lambda for Custom Aggregation

```python
df.groupby('Company')['Sales'].agg(lambda x: (x.max() - x.min()))
```

Calculates the **range** of sales per company.

---

### 3. Sorting Grouped Results

```python
df.groupby('Company')['Sales'].sum().sort_values(ascending=False)
```

Gives total sales per company in descending order.

---

### 4. Filtering Groups

```python
grouped = df.groupby('Company')
grouped.filter(lambda x: x['Sales'].mean() > 200)
```

Keeps only companies with an average sale greater than 200.

---

## Key Takeaways

1. **GroupBy = Split → Apply → Combine.**

   - Split data by key(s)
   - Apply aggregate function
   - Combine results into a summary DataFrame

2. **Common aggregate functions:** `sum()`, `mean()`, `std()`, `count()`,
   `max()`, `min()`.

3. **`describe()`** gives a quick statistical summary of grouped data.

4. You can **aggregate multiple columns** and even **customize aggregations**
   using `agg()`.

5. GroupBy is essential for **data summarization, reporting, and feature
   engineering**.

---

## Practice Questions

1. What does the GroupBy method do in Pandas?
2. Write a command to find the average sales for each company.
3. How can you get the total sales for Facebook using GroupBy?
4. Which method provides multiple statistical summaries for grouped data?
5. Write a command to find the company with the highest total sales.
6. How can you perform grouping by two columns, e.g., `Company` and
   `Department`?
7. Write a one-liner to get the maximum and minimum sales per company using
   `agg()`.
8. How can you filter out groups whose mean sales are less than 200?

---

## Answers

1. The **GroupBy** method groups rows based on a column and applies aggregate
   functions like sum, mean, etc.
2. ```python
   df.groupby('Company')['Sales'].mean()
   ```
3. ```python
   df.groupby('Company').sum().loc['Facebook']
   ```
4. The `describe()` method.
5. ```python
   df.groupby('Company')['Sales'].sum().idxmax()
   ```
6. ```python
   df.groupby(['Company', 'Department']).mean()
   ```
7. ```python
   df.groupby('Company')['Sales'].agg(['max', 'min'])
   ```
8. ```python
   df.groupby('Company').filter(lambda x: x['Sales'].mean() >= 200)
   ```
