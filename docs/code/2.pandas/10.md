---

title: Data Input and Output with Pandas
sidebar_label: Data Input and Output with Pandas
sidebar_position: 10
--------------------

## Introduction

Data rarely exists inside Python code ‚Äî it comes from **external sources** like CSV files, Excel workbooks, web pages, or SQL databases.
The **Pandas I/O (Input/Output)** API provides a unified interface for **reading data into DataFrames** and **writing DataFrames back out** to those formats.

In this lesson, you‚Äôll learn:

* How to read and write **CSV** and **Excel** files
* How to extract **HTML tables** from web pages
* How to store and retrieve data from **SQL databases**

---

## Understanding I/O Functions in Pandas

Before we dive in, let‚Äôs clarify some important **keywords**:

| Keyword                | Explanation                                                                                       |
| ---------------------- | ------------------------------------------------------------------------------------------------- |
| **DataFrame**          | A 2D labeled data structure (rows + columns). Like a spreadsheet in memory.                       |
| **`read_*()` methods** | Functions that load data into Pandas (e.g., `read_csv`, `read_excel`, `read_sql`, `read_html`).   |
| **`to_*()` methods**   | Functions that save DataFrames back to a file or database (e.g., `to_csv`, `to_excel`, `to_sql`). |
| **`index`**            | A row label in a DataFrame; similar to a primary key in SQL.                                      |
| **`engine`**           | Refers to the backend used to read/write files or databases (e.g., SQLite, openpyxl).             |

---

## 1. Reading and Writing CSV Files

### What is a CSV File?

A **CSV (Comma-Separated Values)** file is a plain-text file where each line
represents a row and each value is separated by commas.

Example:

```
name,age,city
Alice,30,London
Bob,25,Paris
```

### Reading a CSV File

To load a CSV file into a DataFrame:

```python
import pandas as pd

df = pd.read_csv('example.csv')
print(df.head())
```

**Explanation:**

- `pd.read_csv()` reads the file and automatically infers column names and data
  types.
- The file path `'example.csv'` can be **relative** (same folder) or
  **absolute** (full path).

> üí° To verify your working directory in Jupyter, run:
>
> ```python
> !pwd
> ```

---

### Writing a CSV File

```python
df.to_csv('my_output.csv', index=False)
```

**Explanation of Parameters:**

- `index=False` ‚Üí prevents Pandas from writing the index as a column named
  ‚ÄúUnnamed: 0‚Äù.
- Omitting it will save the index by default.

**Pitfall:** If you save without `index=False` and then re-read the file, you‚Äôll
often see an extra ‚ÄúUnnamed: 0‚Äù column.

---

### Quick Recap: Other File Formats

You can type `pd.read_` + **Tab** (in Jupyter) to see all supported formats:

- `read_csv()`
- `read_excel()`
- `read_html()`
- `read_json()`
- `read_sql()`
- `read_parquet()`
- `read_pickle()`

---

## 2. Reading and Writing Excel Files

Excel files can store data in **worksheets (sheets)** with tabular data. Pandas
supports reading/writing Excel files but not formulas or macros.

### Reading Excel

```python
df = pd.read_excel('Excel_Sample.xlsx', sheet_name='Sheet1')
```

**Explanation:**

- `sheet_name` specifies which sheet to read.
- Requires the `openpyxl` or `xlrd` package. Install with:

  ```
  pip install openpyxl
  ```

### Writing Excel

```python
df.to_excel('Excel_Sample2.xlsx', sheet_name='NewSheet')
```

> ‚ö†Ô∏è Only **data** is written ‚Äî not formatting, charts, or formulas.

---

## 3. Reading HTML Tables from the Web

Pandas can scrape HTML tables directly from websites ‚Äî this is especially useful
for **financial reports**, **Wikipedia pages**, etc.

### Required Libraries

Before using `read_html()`, install:

```bash
pip install lxml html5lib beautifulsoup4
```

### Example

```python
data = pd.read_html('https://www.fdic.gov/resources/resolutions/bank-failures/failed-bank-list/')
print(len(data))
print(data[0].head())
```

**Explanation:**

- `pd.read_html()` scans the webpage and extracts all `<table>` tags.
- It returns a **list of DataFrames**, one per table.
- You can access the first table with `data[0]`.

> ‚ö†Ô∏è Not all websites return perfect tables ‚Äî missing data or formatting issues
> can occur.

---

## 4. Working with SQL Databases

Databases like MySQL, PostgreSQL, or SQLite store data in structured tables.
Pandas can both **read** and **write** data to these databases.

### Step 1: Create a Database Engine

```python
from sqlalchemy import create_engine
engine = create_engine('sqlite:///:memory:')
```

**Explanation of Keywords:**

- `SQLAlchemy` ‚Üí a Python library for connecting to databases.
- `'sqlite:///:memory:'` ‚Üí creates a temporary SQLite database **in memory**
  (not on disk).

---

### Step 2: Writing to SQL

```python
df.to_sql('my_table', engine)
```

- Writes the DataFrame `df` into a table named `'my_table'`.
- If the table doesn‚Äôt exist, Pandas will create it.

---

### Step 3: Reading from SQL

```python
pd.read_sql('my_table', engine)
```

Reads the table and returns it as a DataFrame.

**Note:** When reading from SQL, the index becomes a separate column by default.

---

## Advanced Examples

### 1. Reading from Remote CSV Files

```python
url = "https://people.sc.fsu.edu/~jburkardt/data/csv/airtravel.csv"
pd.read_csv(url)
```

### 2. Writing a Filtered DataFrame

```python
df[df['age'] > 25].to_csv('filtered.csv', index=False)
```

### 3. Appending Data to SQL Table

```python
df.to_sql('my_table', engine, if_exists='append', index=False)
```

### 4. Exporting to Multiple Excel Sheets

```python
with pd.ExcelWriter('multi_sheets.xlsx') as writer:
    df.to_excel(writer, sheet_name='Sheet1')
    df.describe().to_excel(writer, sheet_name='Summary')
```

---

## Key Takeaways

1. **`pd.read_*()`** functions read external files into DataFrames.
2. **`df.to_*()`** functions export DataFrames back to various formats.
3. For HTML or SQL, install dependencies like `lxml`, `sqlalchemy`,
   `beautifulsoup4`.
4. **CSV** is the most universal and lightweight format.
5. Always use `index=False` when saving unless you explicitly need the index.

---

## Practice Questions

1. What does `pd.read_csv()` do?
2. Why is `index=False` often used in `to_csv()`?
3. What are the required libraries for reading HTML tables?
4. How do you read data from a specific sheet in an Excel file?
5. What is the purpose of `create_engine()` in SQL operations?
6. How can you access the second table from `pd.read_html()` output?
7. What parameter would you use to append data to an existing SQL table?
8. Write code to save a DataFrame into two different sheets in one Excel file.

---

## Answers

1. It reads a CSV file into a Pandas DataFrame.
2. It prevents the index from being saved as an extra column in the output file.
3. `lxml`, `html5lib`, and `beautifulsoup4`.
4. ```python
   pd.read_excel('file.xlsx', sheet_name='Sheet1')
   ```
5. It establishes a connection to a database using SQLAlchemy.
6. ```python
   data[1]
   ```
7. Use `if_exists='append'` in `to_sql()`.
8. ```python
   with pd.ExcelWriter('multi_sheets.xlsx') as writer:
       df.to_excel(writer, sheet_name='Sheet1')
       df.describe().to_excel(writer, sheet_name='Summary')
   ```
