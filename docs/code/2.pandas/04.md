---

title: DataFrames - Part 2 Conditional Selection and Indexing
sidebar_label: DataFrames - Part 2
sidebar_position: 4
-------------------

## Introduction

In this lecture, we build upon the basics of DataFrames and explore two powerful features of **Pandas DataFrames**:

1. **Conditional Selection** → Selecting rows or values that satisfy certain conditions.
2. **Index Management** → Resetting and setting new indices to organize and reference data better.

Understanding these concepts is critical for efficient **data filtering, cleaning, and preprocessing**, which are core steps in any data analysis or machine learning workflow.

---

## Conditional Selection in DataFrames

A unique feature of Pandas is the ability to use **comparison operators** (`>`,
`<`, `==`, etc.) directly on DataFrames or Series.

### Example: Entire DataFrame Comparison

```python
bool_df = df > 0
print(bool_df)
```

- Returns a DataFrame of boolean values: `True` where the condition is
  satisfied, `False` otherwise.

If we pass this boolean DataFrame back into the original DataFrame:

```python
df[bool_df]
```

- We get the **values where condition is True**, and `NaN` where it is False.

Shorter version:

```python
df[df > 0]
```

---

## Filtering Rows Based on Column Values

Most often, we filter based on **specific column conditions**.

### Example: Filter by Column `W`

```python
df[df['W'] > 0]
```

- Returns rows where column `W` is greater than 0.

### Example: Filter by Column `Z`

```python
df[df['Z'] < 0]
```

- Returns rows where column `Z` is less than 0.

---

## Selecting Columns After Filtering

We can chain conditions with column selection:

```python
# First filter rows, then select a column
df[df['W'] > 0]['X']

# Select multiple columns
df[df['W'] > 0][['Y','X']]
```

These "one-liners" are common in Pandas but can be split into steps for clarity.

---

## Multiple Conditions in Conditional Selection

When combining multiple conditions:

- Use **&** (logical AND)
- Use **|** (logical OR)
- **Do NOT use `and` or `or`** (they don’t work with Pandas Series).
- Always enclose conditions in parentheses.

### Example: AND condition

```python
df[(df['W'] > 0) & (df['Y'] > 1)]
```

- Selects rows where both conditions hold true.

### Example: OR condition

```python
df[(df['W'] > 0) | (df['Y'] > 1)]
```

- Selects rows where at least one condition is true.

---

## Resetting and Setting DataFrame Index

### Resetting Index

```python
df.reset_index()
```

- Resets index to default integers and moves the old index into a column named
  `"index"`.

To make it permanent:

```python
df.reset_index(inplace=True)
```

---

### Setting a New Index

We can use an existing column as the new index.

```python
new_ind = 'CA NY WY OR CO'.split()
df['States'] = new_ind
df.set_index('States')
```

To make it permanent:

```python
df.set_index('States', inplace=True)
```

---

## Advanced Examples

### 1. Filter with Multiple Conditions and Select Subset

```python
df[(df['W'] > 0) & (df['Y'] > 1)][['X','Z']]
```

- Rows where both conditions hold, returning only `X` and `Z`.

---

### 2. Use Index After Reset

```python
df.reset_index(inplace=True)
df.set_index('index', inplace=True)
```

- Restores the old index column as the main index.

---

### 3. Conditional Assignment

```python
df['Category'] = np.where(df['W'] > 0, 'Positive', 'Negative')
```

- Creates a new categorical column based on conditions.

---

### 4. Filtering Using `.loc`

```python
df.loc[df['Y'] > 0, ['W','Y','Z']]
```

- More explicit way to filter rows (`Y > 0`) and select columns (`W,Y,Z`).

---

## Key Takeaways

1. Conditional selection in Pandas is similar to Python comparison operations.
2. Use boolean indexing (`df[df['col'] > value]`) to filter rows.
3. Combine multiple conditions using `&` (AND) and `|` (OR), with parentheses.
4. `reset_index()` resets the index; `set_index()` assigns a new one.
5. Both `reset_index()` and `set_index()` are **not in place** by default.

---

## Practice Questions

1. How is conditional selection in Pandas similar to Python’s comparison
   operators?
2. Write code to filter rows where `W > 0` and select only the column `Z`.
3. How do you combine multiple conditions in Pandas conditional selection?
4. Write code to reset a DataFrame’s index permanently.
5. Given a DataFrame with a `"State"` column, how would you make `"State"` the
   new index?
6. Write code to create a new column `"Result"` that labels rows as `"Pass"` if
   `Y > 1` and `"Fail"` otherwise.

---

## Answers

1. Both return boolean values (`True`/`False`) based on the condition; in
   Pandas, these booleans are applied to filter data.
2.

```python
df[df['W'] > 0]['Z']
```

3. Use `&` for AND and `|` for OR, with parentheses around each condition.
4.

```python
df.reset_index(inplace=True)
```

5.

```python
df.set_index('State', inplace=True)
```

6.

```python
df['Result'] = np.where(df['Y'] > 1, 'Pass', 'Fail')
```
