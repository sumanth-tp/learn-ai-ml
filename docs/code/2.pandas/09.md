---

title: Operations in Pandas
sidebar_label: Operations in Pandas
sidebar_position: 9
-------------------

## Introduction

In this section, we will explore some of the **most common and essential operations** available in Pandas that help with **data exploration, transformation, and summarization**.
These operations form the backbone of efficient data manipulation workflows in Pandas and are frequently used in real-world data analysis tasks.

You will learn how to:

* Identify and count unique values
* Apply conditional selections
* Use the powerful `apply()` function for custom transformations
* Sort, drop, and rename data
* Detect missing values
* Create Pivot Tables (similar to Excel)

---

## Setting Up the DataFrame

Let's begin with a simple example DataFrame:

```python
import pandas as pd

df = pd.DataFrame({
    'col1': [1, 2, 3, 4],
    'col2': [4, 5, 6, 4],
    'col3': ['a', 'b', 'c', 'd']
})

print(df)
```

**Output:**

```
   col1  col2 col3
0     1     4    a
1     2     5    b
2     3     6    c
3     4     4    d
```

---

## Finding Unique Values

When analyzing data, it’s often important to check for unique values or the
frequency of values in a column.

### 1. Get Unique Values

```python
df['col2'].unique()
```

**Output:** `array([4, 5, 6])`

Returns all unique elements in the specified column.

---

### 2. Count Number of Unique Values

```python
df['col2'].nunique()
```

**Output:** `3`

---

### 3. Get Value Counts

```python
df['col2'].value_counts()
```

**Output:**

```
4    2
5    1
6    1
Name: col2, dtype: int64
```

This shows how many times each unique value appears in the column.

---

## Conditional Selection

Conditional selection allows you to filter rows that satisfy specific
conditions.

### 1. Single Condition

```python
df[df['col1'] > 2]
```

**Output:**

```
   col1  col2 col3
2     3     6    c
3     4     4    d
```

---

### 2. Multiple Conditions

Use parentheses and the **`&` (and)** or **`|` (or)** operators.

```python
df[(df['col1'] > 2) & (df['col2'] == 4)]
```

**Output:**

```
   col1  col2 col3
3     4     4    d
```

> ⚠️ Remember to use parentheses for each condition and `&` or `|` instead of
> Python’s `and`/`or`.

---

## The `apply()` Method

The **`apply()`** function is one of the most powerful tools in Pandas. It lets
you apply any function (built-in or custom) to a DataFrame column or Series.

### 1. Applying a Custom Function

```python
def times2(x):
    return x * 2

df['col1'].apply(times2)
```

**Output:**

```
0    2
1    4
2    6
3    8
```

---

### 2. Applying Built-in Functions

```python
df['col3'].apply(len)
```

**Output:**

```
0    1
1    1
2    1
3    1
```

---

### 3. Using Lambda Expressions

Instead of defining a separate function, use a one-liner:

```python
df['col2'].apply(lambda x: x * 2)
```

**Output:**

```
0     8
1    10
2    12
3     8
```

---

## Removing Columns

To remove a column, use the **`drop()`** method.

```python
df.drop('col1', axis=1, inplace=True)
```

- `axis=1` → drop a column
- `axis=0` → drop a row
- `inplace=True` → apply the change permanently

---

## Retrieving Column and Index Names

```python
df.columns
df.index
```

**Output:**

```
Index(['col2', 'col3'], dtype='object')
RangeIndex(start=0, stop=4, step=1)
```

These are useful when dynamically iterating or renaming columns.

---

## Sorting and Ordering

You can sort the DataFrame by values in a particular column:

```python
df.sort_values(by='col2')
```

**Output:**

```
   col1  col2 col3
0     1     4    a
3     4     4    d
1     2     5    b
2     3     6    c
```

> Use `ascending=False` to sort in descending order.

---

## Finding Null Values

To check for missing data:

```python
df.isnull()
```

**Output:**

```
   col1   col2   col3
0  False  False  False
1  False  False  False
2  False  False  False
3  False  False  False
```

You can also count missing values:

```python
df.isnull().sum()
```

---

## Pivot Tables in Pandas

Pivot tables summarize data by aggregating values. They are conceptually similar
to **Excel Pivot Tables**, and incredibly powerful for data summarization.

### Example:

```python
df2 = pd.DataFrame({
    'A': ['foo', 'foo', 'bar', 'bar'],
    'B': [1, 2, 1, 2],
    'C': ['X', 'Y', 'X', 'Y'],
    'D': [10, 20, 30, 40]
})

df2.pivot_table(values='D', index=['A', 'B'], columns=['C'])
```

**Output:**

```
C        X     Y
A   B
bar 1  30.0   NaN
    2   NaN  40.0
foo 1  10.0   NaN
    2   NaN  20.0
```

If a combination doesn’t exist in the data, the cell will show `NaN`.

---

## Advanced Examples

### 1. Apply with Conditional Logic

```python
df['col1'].apply(lambda x: 'Even' if x % 2 == 0 else 'Odd')
```

### 2. Sort by Multiple Columns

```python
df.sort_values(by=['col2', 'col3'], ascending=[True, False])
```

### 3. Count Unique Values Across All Columns

```python
df.nunique()
```

### 4. Replace Missing Data

```python
df.fillna('Missing')
```

---

## Key Takeaways

1. **Unique Operations** → `unique()`, `nunique()`, and `value_counts()` help in
   understanding column distributions.
2. **Conditional Selection** → Enables logical filtering using `&` and `|`.
3. **Apply Method** → Run custom or lambda functions across Series or
   DataFrames.
4. **Sorting, Dropping, and Null Checks** → Core operations for cleaning data.
5. **Pivot Tables** → Summarize large datasets efficiently using multi-index
   structures.

---

## Practice Questions

1. What does the `unique()` method return?
2. How can you count the frequency of each value in a column?
3. Write code to filter rows where `col1 > 2` and `col2 == 4`.
4. What’s the difference between `axis=0` and `axis=1` in the `drop()` method?
5. Write a lambda function to double the values in `col2`.
6. How can you find the number of missing values in each column?
7. Write a pivot table that shows the average of `D` grouped by `A` and `B`.
8. How do you sort the DataFrame in descending order by column `col2`?

---

## Answers

1. It returns an **array of unique values** from the specified column.
2. Using `value_counts()`.
3. ```python
   df[(df['col1'] > 2) & (df['col2'] == 4)]
   ```
4. `axis=0` applies operation on rows, while `axis=1` applies on columns.
5. ```python
   df['col2'].apply(lambda x: x * 2)
   ```
6. ```python
   df.isnull().sum()
   ```
7. ```python
   df2.pivot_table(values='D', index=['A', 'B'], aggfunc='mean')
   ```
8. ```python
   df.sort_values(by='col2', ascending=False)
   ```
